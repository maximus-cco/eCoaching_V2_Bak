<table class="tables table-hover table-bordered" id="tbl-report" style="font-size: 0.8em; width:100%">
    <thead>
        <tr>
            <th data-orderable="false">Employee Level ID</th>
            <th data-orderable="false">Employee Level</th>
            <th data-orderable="false">Coaching ID</th>
            <th data-orderable="false">Log Name</th>
            <th data-orderable="false">Quality Now Batch ID</th>
            <th data-orderable="false">Quality Now Batch Status</th>
            <th data-orderable="false">Status</th>
            <th data-orderable="false">Employee ID</th>
            <th data-orderable="false">Employee Name</th>
            <th data-orderable="false">Site</th>
            <th data-orderable="false">Supervisor Employee ID</th>
            <th data-orderable="false">Supervisor Name</th>
            <th data-orderable="false">Manager Employee ID</th>
            <th data-orderable="false">Manager Name</th>
            <th data-orderable="false">Current Supervisor Employee ID</th>
            <th data-orderable="false">Current Supervisor Name</th>
            <th data-orderable="false">Current Manager Employee ID</th>
            <th data-orderable="false">Current Manager Name</th>
            <th data-orderable="false">Review Supervisor Employee ID</th>
            <th data-orderable="false">Review Supervisor Name</th>
            <th data-orderable="false">Review Manager Employee ID</th>
            <th data-orderable="false">Review Manager Name</th>
            <th data-orderable="false">Strength and Opportunities</th>
            <th data-orderable="false">Evaluation Summary</th>
            <th data-orderable="false">Coaching Notes</th>
            <th data-orderable="false">Event Date</th>
            <th data-orderable="false">Coaching Date</th>
            <th data-orderable="false">Submitted Date</th>
            <th data-orderable="false">Coaching Source</th>
            <th data-orderable="false">Sub Coaching Source</th>
            <th data-orderable="false">Coaching Reason</th>
            <th data-orderable="false">Sub Coaching Reason</th>
            <th data-orderable="false">Value</th>
            <th data-orderable="false">Submitter ID</th>
            <th data-orderable="false">Submitter Name</th>
            <th data-orderable="false">Supervisor Reviewed Date</th>
            <th data-orderable="false">Manager Reviewed Manual Date</th>
            <th data-orderable="false">Manager Reviewed Auto Date</th>
            <th data-orderable="false">Manager Notes</th>
            <th data-orderable="false">Employee Reviewed Date</th>
            <th data-orderable="false">Employee Comments</th>
            <th data-orderable="false">Follow up Required</th>
            <th data-orderable="false">Follow-up Date</th>
            <th data-orderable="false">Follow-up Coaching Date</th>
            <th data-orderable="false">Follow-up Coaching Notes</th>
            <th data-orderable="false">Supervisor Follow-up Auto Date</th>
            <th data-orderable="false">CSR Follow up Acknowledged</th>
            <th data-orderable="false">CSR Follow-up Auto Date</th>
            <th data-orderable="false">CSR Follow-up Comments</th>
            <th data-orderable="false">Follow up Supervisor ID</th>
            <th data-orderable="false">Supervisor Follow up Review Auto Date</th>
            <th data-orderable="false">Supervisor Follow up Review Coaching Notes</th>
            <th data-orderable="false">Follow up Review Monitored Logs</th>
            <th data-orderable="false">Follow up Review Supervisor ID</th>
            <th data-orderable="false">Program</th>
            <th data-orderable="false">Channel</th>
            <th data-orderable="false">Verint ID</th>
            <th data-orderable="false">Activity ID</th>
            <th data-orderable="false">DCN</th>
            <th data-orderable="false">Verint Form Name</th>
            <th data-orderable="false">Coaching Monitor</th>
            <th data-orderable="false">Evaluation Status</th>
            <th data-orderable="false">Reason For Contact</th>
            <th data-orderable="false">Reason For Contact Comments</th>
            <th data-orderable="false">Business Process</th>
            <th data-orderable="false">Business Process Reason</th>
            <th data-orderable="false">Business Process Comment</th>
            <th data-orderable="false">Info Accuracy</th>
            <th data-orderable="false">Info Accuracy Reason</th>
            <th data-orderable="false">Info Accuracy Comment</th>
            <th data-orderable="false">Privacy Disclaimers</th>
            <th data-orderable="false">Privacy Disclaimers Reason</th>
            <th data-orderable="false">Privacy Disclaimers Comment</th>
            <th data-orderable="false">Issue Resolution</th>
            <th data-orderable="false">Issue Resolution Comment</th>
            <th data-orderable="false">Business Correspondence</th>
            <th data-orderable="false">Business Correspondence Comment</th>
            <th data-orderable="false">Call Efficiency</th>
            <th data-orderable="false">Call Efficiency Comment</th>
            <th data-orderable="false">Chat Efficiency</th>
            <th data-orderable="false">Chat Efficiency Comment</th>
            <th data-orderable="false">Active Listening</th>
            <th data-orderable="false">Active Listening Comment</th>
            <th data-orderable="false">Issue Diagnosis</th>
            <th data-orderable="false">Issue Diagnosis Comment</th>
            <th data-orderable="false">Personality Flexing</th>
            <th data-orderable="false">Personality Flexing Comment</th>
            <th data-orderable="false">Professional Communication</th>
            <th data-orderable="false">Professional Communication Comment</th>
            <th data-orderable="false">Customer Temp Start</th>
            <th data-orderable="false">Customer Temp Start Comment</th>
            <th data-orderable="false">Customer Temp End</th>
            <th data-orderable="false">Customer Temp End Comment</th>
        </tr>
    </thead>
</table>

<script>
    $(document).ready(function () {
        const length = $('#PageSize').val();
        const viewModel = @Html.Raw(Json.Encode(Model));
        $(".please-wait").slideDown(500);

        const qnLogTbl = $('#tbl-report').DataTable({
            //ordering: false,
            renderer: "bootstrap",
            autowidth: false,
            language: {
                processing: "<span>Loading...... Please wait...</span>",
                emptyTable: "No data found."
            },
            processing: true,
            serverSide: true,       // Process server side
            filter: false,          // Disable filter (search box)
            pageLength: length,
            ajax: {
                url: '@Url.Action("GetData")',
                type: "POST",
                //datatype: "json",
                data: viewModel
            },
            columns: [
                { data: "ModuleId" },
                { data: "ModuleName" },
                { data: "CoachingID" },
                { data: "LogName" },
                { data: "QualityNowBatchID" },
                { data: "QualityNowBatchStatus" },
                { data: "Status" },
                { data: "EmployeeID" },
                { data: "EmployeeName" },
                { data: "Site" },
                { data: "SupervisorEmployeeID" },
                { data: "SupervisorName" },
                { data: "ManagerEmployeeID" },
                { data: "ManagerName" },
                { data: "CurrentSupervisorEmployeeID" },
                { data: "CurrentSupervisorName" },
                { data: "CurrentManagerEmployeeID" },
                { data: "CurrentManagerName" },
                { data: "ReviewSupervisorEmployeeID" },
                { data: "ReviewSupervisorName" },
                { data: "ReviewManagerEmployeeID" },
                { data: "ReviewManagerName" },
                { data: "StrengthandOpportunities" },
                { data: "EvaluationSummary" },
                { data: "CoachingNotes" },
                { data: "EventDate" },
                { data: "CoachingDate" },
                { data: "SubmittedDate" },
                { data: "CoachingSource" },
                { data: "SubCoachingSource" },
                { data: "CoachingReason" },
                { data: "SubCoachingReason" },
                { data: "Value" },
                { data: "SubmitterID" },
                { data: "SubmitterName" },
                { data: "SupervisorReviewedDate" },
                { data: "ManagerReviewedManualDate" },
                { data: "ManagerReviewedAutoDate" },
                { data: "ManagerNotes" },
                { data: "EmployeeReviewedDate" },
                { data: "EmployeeComments" },
                { data: "FollowupRequired" },
                { data: "FollowupDate" },
                { data: "FollowupCoachingDate" },
                { data: "FollowupCoachingNotes" },
                { data: "SupervisorFollowupAutoDate" },
                { data: "CSRFollowupAcknowledged" },
                { data: "CSRFollowupAutoDate" },
                { data: "CSRFollowupComments" },
                { data: "FollowupSupervisorID" },
                { data: "SupervisorFollowupReviewAutoDate" },
                { data: "SupervisorFollowupReviewCoachingNotes" },
                { data: "FollowupReviewMonitoredLogs" },
                { data: "FollowupReviewSupervisorID" },
                { data: "Program" },
                { data: "Channel" },
                { data: "VerintID" },
                { data: "ActivityID" },
                { data: "DCN" },
                { data: "VerintFormName" },
                { data: "CoachingMonitor" },
                { data: "EvaluationStatus" },
                { data: "ReasonForContact" },
                { data: "ReasonForContactComments" },
                { data: "BusinessProcess" },
                { data: "BusinessProcessReason" },
                { data: "BusinessProcessComment" },
                { data: "InfoAccuracy" },
                { data: "InfoAccuracyReason" },
                { data: "InfoAccuracyComment" },
                { data: "PrivacyDisclaimers" },
                { data: "PrivacyDisclaimersReason" },
                { data: "PrivacyDisclaimersComment" },
                { data: "IssueResolution" },
                { data: "IssueResolutionComment" },
                { data: "BusinessCorrespondence" },
                { data: "BusinessCorrespondenceComment" },
                { data: "CallEfficiency" },
                { data: "CallEfficiencyComment" },
                { data: "ChatEfficiency" },
                { data: "ChatEfficiencyComment" },
                { data: "ActiveListening" },
                { data: "ActiveListeningComment" },
                { data: "IssueDiagnosis" },
                { data: "IssueDiagnosisComment" },
                { data: "PersonalityFlexing" },
                { data: "PersonalityFlexingComment" },
                { data: "ProfessionalCommunication" },
                { data: "ProfessionalCommunicationComment" },
                { data: "CustomerTempStart" },
                { data: "CustomerTempStartComment" },
                { data: "CustomerTempEnd" },
                { data: "CustomerTempEndComment" }
            ],

            initComplete: function (settings, json) {
                $(".please-wait").slideUp(500);

                let recordsTotal = qnLogTbl.page.info().recordsTotal;
                if (recordsTotal > 0) {
                    // show export to excel link
                    $('#div-export-to-excel').removeClass('hide');
                    $('#div-export-to-excel').addClass('show');
                }

                $('#total-records').removeClass('hide');
                $('#total-records').addClass('show');
                $('#TotalRecordsTxt').text(recordsTotal);

                ShowSearchCriteria();

                $("th").removeClass('sorting_desc');
                $("th").removeClass('sorting_asc');
                $("th.sorting_desc, th.sorting_asc").css('cursor', 'default');
            }

        }); // qnLogTbl

        // Set page length
        qnLogTbl.page.len(length);

        $('#tbl-report').on('length.dt', function (e, settings, len) {
            $("input[name='pageSizeSelected']").val(len);
        });

    });

    function ShowSearchCriteria()
    {
        // show what have been entered in search boxes
        $('#div-report-header').removeClass('hide');
        $('#div-report-header').addClass('show');
        $('#StartDateTxt').text($('#StartDate').val());
        $('#EndDateTxt').text($('#EndDate').val());
        $('#SiteTxt').text($('#select-site option:selected').text());
        $('#EmployeeLevelTxt').text($('#select-level  option:selected').text());
        $('#EmployeeTxt').text($('#select-employee  option:selected').text());
        $('#ReasonTxt').text($('#select-reason  option:selected').text());
        $('#SubReasonTxt').text($('#select-subreason  option:selected').text());
        $('#LogStatusTxt').text($('#select-logstatus  option:selected').text());
    }
</script>
